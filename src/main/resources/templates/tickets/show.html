<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">

<head>
	<th:block th:replace="~{fragments/fragments :: head}"></th:block>
	<title>[[${ticket.title}]]</title>
</head>

<body class="bg-primary-subtle">
	<nav th:replace="~{fragments/navbar :: navbar}"></nav>
	<main class="container" th:object="${ticket}">
		<div class="row justify-content-center mb-4">
			<div class="col-12 col-lg-8">
				<h2 class="text-center mb-3">[[*{title}]]</h2>
				<div
					class="row mb-2 fs-6 text justyfy-content-evenly text-center border border-primary rounded blue-background">
					<div class="col-12 col-md-3 d-flex flex-grow-1 flex-shrink-1 align-items-center">
						<span class="fw-medium me-1">Priority:</span>
						<span class="fw-semibold fst-italic">[[*{priority}]]</span>
					</div>
					<div class="col-12 col-md-3 d-flex flex-grow-1 flex-shrink-1 align-items-center">
						<span class="fw-medium me-1">Category: </span>
						<span class="fw-semibold fst-italic">[[*{category.name}]]</span>
					</div>
					<div class="col-12 col-md-3 d-flex flex-grow-1 flex-shrink-1 align-items-center">
						<span class="fw-medium me-1">User: </span>
						<span class="fw-semibold fst-italic">[[*{user.name}]]</span>
					</div>
					<div class="col-12 col-md-3 d-flex flex-grow-1 flex-shrink-1 align-items-center">
						<span class="fw-medium me-1">Status:</span>
						<span class="fw-semibold fst-italic">[[*{status.name}]]</span>
					</div>
				</div>


				<div
					class="row fs-5 border border-primary rounded text-center justify-content-center blue-background mb-4">
					<div class="col-12 col-md-6">
						<div>[[*{content}]]</div>
					</div>
				</div>

				<div class="row fs-5 border border-primary rounded justify-content-center blue-background mb-4"
					th:if="${ticket.notes.size() > 0}">
					<div class="col-12">

						<div th:each="note : ${ticket.notes}">
							<div class="fs-6">
								<span class="fw-medium">Date: </span>
								<span>[[${note.formattedDate}]]</span>
							</div>
							<div class="text-center">[[${note.content}]]</div>
						</div>
					</div>
				</div>

				<div class="row justify-content-center">
					<!-- Button show note input -->
					<div class="d-flex justify-content-end">
						<button class="btn btn-warning me-2">
							<a class="text-decoration-none text-reset"
								th:href="@{/edit/{id} (id=${ticket.id})}">Edit</a>
						</button>
						<form method="post" th:action="@{/delete/{id} (id=${ticket.id})}">
							<button class="btn btn-danger me-2"
								type="submit">Delete</button>
						</form>
						<button type="button" class="btn btn-primary">
							New note
						</button>
					</div>
					<div>
						<form method="post" th:action="@{{ticketId}/note (ticketId=${ticket.id})}">

							<div class="mb-3">
								<label for="note-content" class="form-label">New note</label>
								<textarea class="form-control" id="note-content" th:field="${note.content}"
									rows="5"></textarea>
							</div>
							<div class="d-flex justify-content-end">
								<button type="submit" class="btn btn-warning">Add note</button>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
	</main>
	<script th:replace="~{fragments/fragments :: scripts}"></script>
</body>

</html>